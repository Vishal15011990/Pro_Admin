@model IEnumerable<Pro_Admin.Models.Employee_Master>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>
@*<script src="~/Scripts/jquery-3.5.1.min.js"></script>*@
@*<link href="~/Content/DataTables_2/DataTables-1.10.21/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<script src="~/Content/DataTables_2/datatables.min.js"></script>
<script src="~/Content/DataTables_2/DataTables-1.10.21/js/jquery.dataTables.min.js"></script>*@

<table class="table" id="mytable">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Date_Of_Birth)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Phone)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Address)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EmailId)
        </th>


        <th>
            @Html.DisplayNameFor(model => model.Country_Info.Country_name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.State_info.State_Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.City_Info.City_Name)
        </th>
        <th>
            @Html.DisplayName("Action")
        </th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Date_Of_Birth)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Phone)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Address)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.EmailId)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.Country_Info.Country_name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.State_info.State_Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.City_Info.City_Name)
            </td>

            <td>
                @if (User.IsInRole("Admin"))
                {
                    @Html.ActionLink("Edit", "Edit2", new { id = item.EmpId })
                    <a href="#" class="btnDelete fa fa-trash"></a><input type="hidden" value="@item.EmpId" />
                }|

                @*@Html.ActionLink("Details", "Details", new { id = item.EmpId })*@
            </td>
        </tr>
    }

</table>
<div>
    @Html.Hidden("RedirectToIndex", Url.Action("Index", "Employee_Master"))
</div>

<script>
   @*(function () {
        swal("Welcome", "@User.Identity.Name !", "info")
        $("#mytable").DataTable();
        alertify.alert("Hello", "Welcome @User.Identity.Name!")

    });*@
    (function ($) {

        if (!$.cookie("Login")) {
             swal("Welcome", "@User.Identity.Name !", "info")
            $.cookie("Login", "x");
        }

    })(jQuery);
</script>
<script>
    $(document).ready(function () {
        $(".btnDelete").on("click", function () {
            var id = $(this).next().val();
            alertify.confirm('Are You Sure', 'To Delete !',
                function () {
                    alertify.success('Ok')
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("Delete","Employee_Master")',
                        data: { id: id },
                        dataType: "json",
                        success: function (response) {
                            if (response) {
                                alertify.alert('Successful', 'Record Deleted!',
                                    function () {
                                        alertify.success('Ok');
                                        location.reload();
                                    });
                            }

                            else {
                                alertify.alert('Your Data Is Safe', 'Record Not Deleted!',
                                    function () {
                                        alertify.success('Ok');
                                        location.reload();
                                    });
                            }
                        }
                    });
                }
                , function ()
                {
                    alertify.error('Cancel')
                });
        });
    });
</script>




















            @*$.confirm({
                title: 'Delete !',
                content: 'Do you want to delete ?',
                icon: 'fa fa-trash-o',
                animation: 'scale',
                closeAnimation: 'scale',
                opacity: 0.5,
                buttons: {
                    'confirm': {
                        text: 'Yes',
                        btnClass: 'btn-blue',
                        action: function () {
                            $.ajax({
                                type: "POST",
                                url: '@Url.Action("Delete","Employee_Master")',
                                data: { id: id },
                                dataType: "json",
                                success: function (response) {
                                    if (response) {
                                        $.alert({
                                            title: 'Delete !',
                                            content: 'Record deleted successfully!..!',
                                            icon: 'fa fa-rocket',
                                            animation: 'scale',
                                            closeAnimation: 'scale',
                                            buttons: {
                                                okay: {
                                                    text: 'Okay',
                                                    btnClass: 'btn-wide mb-2 mr-2 btn btn-primary form-control',
                                                    action: function (event, ui) {
                                                        location.reload();
                                                    }
                                                }
                                            }
                                        });
                                    }
                                    else {
                                        $.alert({
                                            title: 'Info !',
                                            content: 'Your Record Is Safe !',
                                            icon: 'fa fa-rocket',
                                            animation: 'scale',
                                            closeAnimation: 'scale',
                                            buttons: {
                                                okay: {
                                                    text: 'Okay',
                                                    btnClass: 'btn-wide mb-2 mr-2 btn btn-primary form-control',
                                                    action: function (event, ui) {
                                                        $(this).remove();
                                                        location.reload();
                                                    }
                                                }
                                            }
                                        });
                                    }
                                },
                                failure: function (response) {
                                    alert(response.responseText);
                                },
                                error: function (response) {
                                    alert(response.responseText);
                                }
                            });
                        }
                    },
                    cancel: function () {
                        $.alert('Deletion <strong>Aborted!</strong>');
                    },
                }
            });
        });*@

